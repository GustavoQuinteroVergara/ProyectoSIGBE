<app-navbar></app-navbar>
<ng-template #modificarAsignacion>
	<div class="row">
		<h1 class="tituloRegistroConvocatoria">MODIFICAR UNA ASIGNACIÓN</h1>	
			<form  class="text-center" [formGroup]="formularioCuposAsignaActualizar">

				<hr>
				<div class="row">
					<div class="col-12">

						<h4>Ingrese fecha</h4>
						<h4><strong>FECHA SELECCIONADA: {{asignacionSel.fechaasignacion.date | date:'dd/MM/yyyy'}}</strong></h4>

						<mat-form-field appearance="fill">
							<mat-label>Ingrese fecha</mat-label>
							<input matInput [matDatepicker]="picker" #fechaact min="{{fechaActual}}" id="start" name="fechaasingacion" required="true" formControlName="fechaactualizar">
							<mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
							<mat-datepicker #picker></mat-datepicker>
						</mat-form-field>
						<mat-error class="help-block form-error text-danger small" *ngIf="formularioCuposAsignaActualizar.controls['fechaactualizar'].hasError('required') &&
            formularioCuposAsignaActualizar.controls['fechaactualizar'].touched">La fecha es requerida</mat-error>

					</div>
				</div>
				<div class="row">
					<div class="col-lg">
						<h4>Ingrese Cupos de almuerzo</h4>
						<mat-form-field class="example-full-width" appearance="fill">
							<mat-label>Cupos Almuerzo</mat-label>
							<input #cuposalmuerzoact type="number" id="cuposalmuerzo" matInput placeholder="Ingrese los cupos de almuerzo" value=""  [value]="asignacionSel.cuposdisponiblesalmuerzo" required="true" formControlName="cuposAlmuerzo">
					</mat-form-field>
											<mat-error class="help-block form-error text-danger small" *ngIf="formularioCuposAsignaActualizar.controls['cuposAlmuerzo'].hasError('required') &&
            formularioCuposAsignaActualizar.controls['cuposAlmuerzo'].touched">Los cupos de almuerzo son requeridos</mat-error>
				</div>
				<div class="col-lg">
					<h4>Ingrese cupos de refrigerio</h4>
					<mat-form-field class="example-full-width" appearance="fill">
						<mat-label>Cupos Refrigerio</mat-label>
						<input #cuposrefrigerioact type="number" id="cuposrefrigerio" matInput placeholder="Ingrese los cupos de refrigerio" value="" [value]="asignacionSel.cuposdisponiblesrefrigerio" required="true" formControlName="cuposRefrigerio">
				</mat-form-field>
										<mat-error class="help-block form-error text-danger small" *ngIf="formularioCuposAsignaActualizar.controls['cuposRefrigerio'].hasError('required') &&
            formularioCuposAsignaActualizar.controls['cuposRefrigerio'].touched">Los cupos de refrigerio son requeridos</mat-error>
			</div>
		</div>

		<div class="row m-4 text-center">
			<div class="col-12">
				<a mat-raised-button color="primary"  [disabled]="true" *ngIf="!formularioCuposAsignaActualizar.valid"  name="action">Actualizar</a>				
				<a mat-raised-button color="primary" *ngIf="formularioCuposAsignaActualizar.valid"
				(click)="actualizarAsignacion(fechaact.value,cuposalmuerzoact.value,cuposrefrigerioact.value)"  name="action">Actualizar</a>
			</div>
		</div>
		</form>
	</div>
</ng-template>
<div class="cuerpopage cup1" data-aos="fade-down" data-aos-once="true"> 
	<div class="formtiq">
	<form [formGroup]="formularioCuposAsigna">
		<h1 class="tituloRegistroConvocatoria"> CREAR UNA ASIGNACIÓN DE CUPOS NUEVA</h1>	
		<hr>
		<div class="row">
			<div class="col-12">

				<h4>Ingrese fecha</h4>

				<mat-form-field appearance="fill">
					<mat-label>Ingrese fecha</mat-label>
					<input matInput [matDatepicker]="picker" #fecha min="{{fechaActual}}" id="start" name="fechaasingacion" formControlName="fecha">
					<mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
					<mat-datepicker #picker></mat-datepicker>
				</mat-form-field>
				<mat-error class="help-block form-error text-danger small"
					*ngIf="formularioCuposAsigna.controls['fecha'].hasError('required') && formularioCuposAsigna.controls['fecha'].touched">
				Cupos de almuerzo es requerido </mat-error>

			</div>
		</div>
		<div class="row">
			<div class="col-6">
				<h4>Ingrese Cupos de almuerzo</h4>
				<mat-form-field class="example-full-width" appearance="fill">
					<mat-label>Cupos Almuerzo</mat-label>
					<input #cuposalmuerzo type="number" id="cuposalmuerzo" matInput placeholder="Ingrese los cupos de almuerzo" value="" formControlName="cuposalmuerzo" >
					<mat-error class="help-block form-error text-danger small"
					*ngIf="formularioCuposAsigna.controls['cuposalmuerzo'].hasError('required') && formularioCuposAsigna.controls['cuposalmuerzo'].touched">
				Cupos de almuerzo es requerido </mat-error>
			</mat-form-field>
		</div>
		<div class="col-6">
			<h4>Ingrese cupos de refrigerio</h4>
			<mat-form-field class="example-full-width" appearance="fill">
				<mat-label>Cupos Refrigerio</mat-label>
				<input #cuposrefrigerio type="number" id="cuposrefrigerio" matInput placeholder="Ingrese los cupos de refrigerio" value="" formControlName="cuposrefrigerio" >
				<mat-error class="help-block form-error text-danger small"
				*ngIf="formularioCuposAsigna.controls['cuposrefrigerio'].hasError('required') && formularioCuposAsigna.controls['cuposrefrigerio'].touched">
			Cupos de refrigerio es requerido </mat-error>
		</mat-form-field>
	</div>
</div>
<!-- Validaciones campos cupos
                    <div class="col-lg">
                        <h4>Ingrese Cupos de almuerzo</h4>
                        <mat-form-field class="example-full-width" appearance="fill">
                            <mat-label>Cupos Almuerzo</mat-label>
                            <input #cuposalmuerzoact type="number" id="cuposalmuerzo" matInput placeholder="Ingrese los cupos de almuerzo" value=""  [value]="asignacionSel.cuposdisponiblesalmuerzo" required="true" formControlName="cuposAlmuerzo">
                    </mat-form-field>
                                            <mat-error class="help-block form-error text-danger small" *ngIf="formularioCuposAsignaActualizar.controls['cuposAlmuerzo'].hasError('required') &&
            formularioCuposAsignaActualizar.controls['cuposAlmuerzo'].touched">Los cupos de almuerzo son requeridos</mat-error>
                </div>

                <div class="col-lg">
                    <h4>Ingrese cupos de refrigerio</h4>
                    <mat-form-field class="example-full-width" appearance="fill">
                        <mat-label>Cupos Refrigerio</mat-label>
                        <input #cuposrefrigerioact type="number" id="cuposrefrigerio" matInput placeholder="Ingrese los cupos de refrigerio" value="" [value]="asignacionSel.cuposdisponiblesrefrigerio" required="true" formControlName="cuposRefrigerio">
                </mat-form-field>
                                        <mat-error class="help-block form-error text-danger small" *ngIf="formularioCuposAsignaActualizar.controls['cuposRefrigerio'].hasError('required') &&
            formularioCuposAsignaActualizar.controls['cuposRefrigerio'].touched">Los cupos de refrigerio son requeridos</mat-error>
            </div>
        </div>


-->
<div class="row m-4 text-center">
	<div class="col-12">
		<a mat-raised-button color="primary" [disabled]="true" *ngIf="!formularioCuposAsigna.valid" name="action">Registrar</a>
		<a mat-raised-button color="primary" *ngIf="formularioCuposAsigna.valid"
		(click)="registrarAsignacion(fecha.value,cuposalmuerzo.value,cuposrefrigerio.value)"  name="action">Registrar</a>
	</div>
</div>
</form>
<div class="row">
	<div class="col-lg">
		<h4>Digita y filtra la tabla</h4>
        <mat-form-field class="example-full-width" style="width: 100%;" appearance="fill" class="inputsEspacio">
              <mat-label>Digita para filtrar</mat-label>
              <input   matInput (keyup)="applyFilter($event.target.value)">
        </mat-form-field>
	</div>
	<div class="col-12">
		

		<h1>ASIGNACIONES CREADAS</h1>
		<hr>
                  <div class="mat-elevation-z8">
                  <table mat-table [dataSource]="dataSource" matSort style="width: 100%;">

                    <!-- ID Column -->
                    <ng-container matColumnDef="consecutivo_cupostickets">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header>Codigo asignación</th>
                      <td mat-cell *matCellDef="let row"> {{row.consecutivo_cupostickets}}</td>
                    </ng-container>

                    <!-- Progress Column -->
                    <ng-container matColumnDef="fechaasignacion">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header>Fecha de asignación</th>
                      <td mat-cell *matCellDef="let row"> {{row.fechaasignacion.date | date:'dd/MM/yyyy'}} </td>
                    </ng-container>

                    <!-- Name Column -->
                    <ng-container matColumnDef="cuposdisponiblesalmuerzo">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header>Cupos de almuerzo</th>
                      <td mat-cell *matCellDef="let row"> {{row.cuposdisponiblesalmuerzo}} </td>
                    </ng-container>

                    <!-- Color Column -->
                    <ng-container matColumnDef="cuposdisponiblesrefrigerio">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header>Cupos de refrigerio</th>
                      <td mat-cell *matCellDef="let row" > {{row.cuposdisponiblesrefrigerio}} </td>
                    </ng-container>
                      <!-- Color Column -->
                    <ng-container matColumnDef="Acciones">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header>Acciones</th>
                      <td mat-cell *matCellDef="let row" > <a data-title="Editar asignación de cupos" style="cursor: pointer;" (click)="abrirModalModificar(row,modificarAsignacion)"><i class="icofont-edit" style="font-size: 20px;"></i></a></td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

                    <!-- Row shown when there is no matching data. -->
                    <tr class="mat-row" *matNoDataRow>
                      <td class="mat-cell" colspan="4">No hay datos que coincidan con lo consultado</td>
                    </tr>
                  </table>
                  <mat-paginator [pageSizeOptions]="[5, 10, 20, 50, 100]"></mat-paginator>
                  </div>




	</div>
</div>
</div>
</div>
